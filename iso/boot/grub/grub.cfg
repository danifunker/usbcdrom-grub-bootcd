# GRUB2 Boot Configuration for USBHLPCD - Simple Compatibility Version
# Optimized for IDE-connected drives in BIOS systems

# Basic configuration
set timeout=0
set default=0

# Limit disk scan to prevent "disk not found" errors
set bios_boot=1

# Add some visual styling
set menu_color_normal=white/black
set menu_color_highlight=black/light-gray

# Try to find our device by filesystem label
search --no-floppy --label USBHLPCD --set=root
set prefix=($root)/boot/grub
set image_dir=($root)/images

menuentry "Boot USB CD-ROM (waits 10 seconds for devices)" {

# Load essential modules (simplified syntax)
insmod ata
insmod biosdisk
insmod pata
insmod iso9660

# USB support modules
insmod usb
insmod uhci
insmod ohci
insmod ehci
insmod usbms

# Try to find our device by filesystem label
search --no-floppy --label USBHLPCD --set=root
set prefix=($root)/boot/grub
set image_dir=($root)/images

sleep 10

  linux16 $prefix/../memdisk iso raw
  initrd16 (usb0)
}

menuentry "Boot from Windows 98 Floppy Image with USB CDROM Support" {

# Load essential modules (simplified syntax)
insmod ata
insmod biosdisk
insmod pata
insmod iso9660

# USB support modules
insmod usb
insmod uhci
insmod ohci
insmod ehci
insmod usbms

# Try to find our device by filesystem label
search --no-floppy --label USBHLPCD --set=root
set prefix=($root)/boot/grub
set image_dir=($root)/images


  # Load the memdisk module
  
  # Boot from the floppy image
  linux16 $prefix/../memdisk
  initrd16 $image_dir/w98_boot.img
}

menuentry "Boot MSDOS 6.22 Basic Floppy Image (no setup.bat)" {

# Load essential modules (simplified syntax)
insmod ata
insmod biosdisk
insmod pata
insmod iso9660

# USB support modules
insmod usb
insmod uhci
insmod ohci
insmod ehci
insmod usbms

# Try to find our device by filesystem label
search --no-floppy --label USBHLPCD --set=root
set prefix=($root)/boot/grub
set image_dir=($root)/images


  # Load the memdisk module
  
  # Boot from the floppy image
  linux16 $prefix/../memdisk
  initrd16 $image_dir/msdos622-with-usbcdrom.img
}

# Load essential modules (simplified syntax)
insmod ata
insmod biosdisk
insmod pata
insmod iso9660

# USB support modules
insmod usb
insmod uhci
insmod ohci
insmod ehci
insmod usbms

# Try to find our device by filesystem label
search --no-floppy --label USBHLPCD --set=root
set prefix=($root)/boot/grub
set image_dir=($root)/images



# Add a fallback option
menuentry "Boot from first hard disk" {
  insmod chain
  insmod part_gpt
  chainloader (hd0,1)+1
}
