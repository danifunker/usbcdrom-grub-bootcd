# Set the prefix and root variables explicitly
set prefix=(cd0)/boot/grub
set root=(cd0)

# Basic configuration
set timeout=10
set default=0

# Add some visual styling
set menu_color_normal=white/black
set menu_color_highlight=black/light-gray

# Fix indentation for module loading
# These will load now that prefix is set
insmod usb
insmod part_msdos
insmod uhci
insmod ohci
insmod ehci
insmod usbms

# Diagnostic menu entry to help troubleshoot
menuentry "List Devices and Files" {
  echo "Available devices:"
  ls
  echo "Files in root:"
  ls /
  echo "Boot directory:"
  ls /boot
  echo "GRUB directory:"
  ls /boot/grub
  echo "Press ESC to return to menu"
  sleep 30
}

menuentry "Boot USB CD-ROM" {
  linux16 /boot/memdisk iso raw
  initrd16 (usb0)
}

menuentry "Boot from Windows 98 Floppy Image with USB CDROM Support" {
  # Boot from the floppy image
  linux16 /boot/memdisk
  initrd16 /images/w98_boot.img
}

menuentry "Boot MSDOS 6.22 Basic Floppy Image (no setup.bat)" {
  # Boot from the floppy image
  linux16 /boot/memdisk
  initrd16 /images/msdos622-with-usbcdrom.img
}

# Add a fallback option
menuentry "Boot from first hard disk" {
  insmod chain
  insmod part_gpt
  chainloader (hd0,1)+1
}

